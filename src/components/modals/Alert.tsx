import { useState, useRef } from "react";

import {
  Box,
  Modal,
  ModalOverlay,
  ModalContent,
  ModalHeader,
  ModalBody,
  ModalFooter,
  Text,
  useColorMode,
  Link,
} from "@chakra-ui/react";
import { IoIosMail } from "react-icons/io";
import { FaLine } from "react-icons/fa";
import { PhoneIcon } from "@/components/ui/icons";
import { AnimationImage } from "@/components/ui/CustomImage";
import { SunderText, ScrollText } from "@/components/ui/CustomText";

interface AlertModalProps {
  isOpen: boolean;
  onClose: () => void;
}

export const AlertModal: React.FC<AlertModalProps> = ({ isOpen, onClose }) => {
  const { colorMode } = useColorMode();
  const dummyRef = useRef(null);

  return (
    <Modal isOpen={isOpen} onClose={onClose} initialFocusRef={dummyRef}>
      <ModalOverlay />
      <ModalContent
        overflow="hidden"
        bg={
          colorMode === "light"
            ? "rgba(240, 228, 218, 0.8)"
            : "rgba(51, 51, 51, 0.8)"
        }
        backdropFilter="blur(10px)"
        style={{
          WebkitBackdropFilter: "blur(10px)", // Safari対応
        }}
      >
        <Box
          p={0} // パディングを設定
          filter={colorMode === "light" ? "" : "invert(1)"} // 白黒を入れ替えるフィルターを適用
        >
          <Box
            ref={dummyRef}
            tabIndex={-1}
            position="absolute"
            width="1px"
            height="1px"
            opacity={0}
          />
          <ModalHeader></ModalHeader>
          <ModalBody py={0} px={3}>
            <Box
              display="flex"
              flexDirection="column"
              alignItems="center" // 垂直方向の中央寄せ
            >
              <Box
                display="flex"
                justifyContent="center"
                alignItems="center"
                width="550px"
                height="550px"
                position="relative"
              >
                <svg
                  width="400"
                  height="400"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="70.9 170 115 115"
                  style={{ transform: "scale(1.9) rotate(18deg)" }}
                >
                  <path
                    d="m 100.75502,265.1916 c -2.16308,-1.10542 -3.495995,-3.10693 -5.129849,-7.703 -2.17034,-6.10521 -2.672624,-6.82025 -7.240335,-10.30721 -3.464822,-2.645 -4.955033,-4.20358 -5.725751,-5.98841 -0.901572,-2.08788 -0.788166,-3.52146 0.711847,-8.99849 0.808263,-2.95123 1.304931,-5.26354 1.32251,-6.15715 0.01682,-0.85486 -0.517511,-3.34681 -1.327075,-6.18909 -2.368648,-8.3161 -1.878074,-9.82593 4.926281,-15.16153 2.325605,-1.82361 4.222617,-3.52557 4.711482,-4.22705 0.511028,-0.73327 1.468359,-2.89591 2.549152,-5.75859 2.005777,-5.3127 2.756667,-6.53915 4.713278,-7.69833 1.67262,-0.99096 3.79434,-1.37594 8.15213,-1.47923 5.74494,-0.13618 6.57159,-0.41942 11.91598,-4.08295 6.46761,-4.43348 8.51988,-4.39608 15.33151,0.27939 4.72345,3.24215 6.09207,3.70486 11.27986,3.8136 8.79102,0.18428 10.44075,1.29311 13.11462,8.81477 2.17033,6.1052 2.67262,6.82025 7.24033,10.3072 3.46482,2.64502 4.95503,4.20359 5.72574,5.98843 0.90158,2.08787 0.78817,3.52145 -0.71184,8.99847 -0.80826,2.95124 -1.30493,5.26355 -1.32251,6.15716 -0.0168,0.85485 0.51751,3.3468 1.32707,6.18909 2.36616,8.3073 1.87387,9.80901 -4.98223,15.19816 -2.27387,1.78734 -4.17056,3.49455 -4.65552,4.19042 -0.51103,0.73328 -1.46836,2.89592 -2.54915,5.75859 -2.00578,5.31269 -2.75667,6.53914 -4.71328,7.69834 -1.67262,0.99094 -3.79434,1.37594 -8.15213,1.47922 -5.74075,0.13607 -6.57387,0.42099 -11.89289,4.06712 -6.52163,4.47051 -8.52093,4.43654 -15.35547,-0.26092 -4.76078,-3.27214 -6.01383,-3.68538 -11.68428,-3.85324 -4.01838,-0.11896 -6.35848,-0.45078 -7.57947,-1.07475 z"
                    fill="#222"
                    stroke="#000"
                    stroke-width="0.3"
                  />
                </svg>
                <svg
                  width="400"
                  height="400"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="70.9 170 115 115"
                  style={{
                    position: "absolute",
                    transform: "scale(1.8) rotate(18deg)",
                  }}
                >
                  <path
                    d="m 100.75502,265.1916 c -2.16308,-1.10542 -3.495995,-3.10693 -5.129849,-7.703 -2.17034,-6.10521 -2.672624,-6.82025 -7.240335,-10.30721 -3.464822,-2.645 -4.955033,-4.20358 -5.725751,-5.98841 -0.901572,-2.08788 -0.788166,-3.52146 0.711847,-8.99849 0.808263,-2.95123 1.304931,-5.26354 1.32251,-6.15715 0.01682,-0.85486 -0.517511,-3.34681 -1.327075,-6.18909 -2.368648,-8.3161 -1.878074,-9.82593 4.926281,-15.16153 2.325605,-1.82361 4.222617,-3.52557 4.711482,-4.22705 0.511028,-0.73327 1.468359,-2.89591 2.549152,-5.75859 2.005777,-5.3127 2.756667,-6.53915 4.713278,-7.69833 1.67262,-0.99096 3.79434,-1.37594 8.15213,-1.47923 5.74494,-0.13618 6.57159,-0.41942 11.91598,-4.08295 6.46761,-4.43348 8.51988,-4.39608 15.33151,0.27939 4.72345,3.24215 6.09207,3.70486 11.27986,3.8136 8.79102,0.18428 10.44075,1.29311 13.11462,8.81477 2.17033,6.1052 2.67262,6.82025 7.24033,10.3072 3.46482,2.64502 4.95503,4.20359 5.72574,5.98843 0.90158,2.08787 0.78817,3.52145 -0.71184,8.99847 -0.80826,2.95124 -1.30493,5.26355 -1.32251,6.15716 -0.0168,0.85485 0.51751,3.3468 1.32707,6.18909 2.36616,8.3073 1.87387,9.80901 -4.98223,15.19816 -2.27387,1.78734 -4.17056,3.49455 -4.65552,4.19042 -0.51103,0.73328 -1.46836,2.89592 -2.54915,5.75859 -2.00578,5.31269 -2.75667,6.53914 -4.71328,7.69834 -1.67262,0.99094 -3.79434,1.37594 -8.15213,1.47922 -5.74075,0.13607 -6.57387,0.42099 -11.89289,4.06712 -6.52163,4.47051 -8.52093,4.43654 -15.35547,-0.26092 -4.76078,-3.27214 -6.01383,-3.68538 -11.68428,-3.85324 -4.01838,-0.11896 -6.35848,-0.45078 -7.57947,-1.07475 z"
                    fill="#82d9d0"
                    stroke="#000"
                    stroke-width="0.3"
                  />
                </svg>
                <svg
                  width="400"
                  height="400"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="70.9 170 115 115"
                  style={{
                    position: "absolute",
                    transform: "scale(1.74) rotate(18deg)",
                  }}
                >
                  <path
                    d="m 100.75502,265.1916 c -2.16308,-1.10542 -3.495995,-3.10693 -5.129849,-7.703 -2.17034,-6.10521 -2.672624,-6.82025 -7.240335,-10.30721 -3.464822,-2.645 -4.955033,-4.20358 -5.725751,-5.98841 -0.901572,-2.08788 -0.788166,-3.52146 0.711847,-8.99849 0.808263,-2.95123 1.304931,-5.26354 1.32251,-6.15715 0.01682,-0.85486 -0.517511,-3.34681 -1.327075,-6.18909 -2.368648,-8.3161 -1.878074,-9.82593 4.926281,-15.16153 2.325605,-1.82361 4.222617,-3.52557 4.711482,-4.22705 0.511028,-0.73327 1.468359,-2.89591 2.549152,-5.75859 2.005777,-5.3127 2.756667,-6.53915 4.713278,-7.69833 1.67262,-0.99096 3.79434,-1.37594 8.15213,-1.47923 5.74494,-0.13618 6.57159,-0.41942 11.91598,-4.08295 6.46761,-4.43348 8.51988,-4.39608 15.33151,0.27939 4.72345,3.24215 6.09207,3.70486 11.27986,3.8136 8.79102,0.18428 10.44075,1.29311 13.11462,8.81477 2.17033,6.1052 2.67262,6.82025 7.24033,10.3072 3.46482,2.64502 4.95503,4.20359 5.72574,5.98843 0.90158,2.08787 0.78817,3.52145 -0.71184,8.99847 -0.80826,2.95124 -1.30493,5.26355 -1.32251,6.15716 -0.0168,0.85485 0.51751,3.3468 1.32707,6.18909 2.36616,8.3073 1.87387,9.80901 -4.98223,15.19816 -2.27387,1.78734 -4.17056,3.49455 -4.65552,4.19042 -0.51103,0.73328 -1.46836,2.89592 -2.54915,5.75859 -2.00578,5.31269 -2.75667,6.53914 -4.71328,7.69834 -1.67262,0.99094 -3.79434,1.37594 -8.15213,1.47922 -5.74075,0.13607 -6.57387,0.42099 -11.89289,4.06712 -6.52163,4.47051 -8.52093,4.43654 -15.35547,-0.26092 -4.76078,-3.27214 -6.01383,-3.68538 -11.68428,-3.85324 -4.01838,-0.11896 -6.35848,-0.45078 -7.57947,-1.07475 z"
                    fill="#FF5833"
                    stroke="#000"
                    stroke-width="0.3"
                  />
                </svg>
                <svg
                  width="450"
                  height="500"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="70.9 170 115 115"
                  style={{ position: "absolute" }}
                >
                  <path
                    id="scaling-path2"
                    d="m 100.75502,265.1916 c -2.16308,-1.10542 -3.495995,-3.10693 -5.129849,-7.703 -2.17034,-6.10521 -2.672624,-6.82025 -7.240335,-10.30721 -3.464822,-2.645 -4.955033,-4.20358 -5.725751,-5.98841 -0.901572,-2.08788 -0.788166,-3.52146 0.711847,-8.99849 0.808263,-2.95123 1.304931,-5.26354 1.32251,-6.15715 0.01682,-0.85486 -0.517511,-3.34681 -1.327075,-6.18909 -2.368648,-8.3161 -1.878074,-9.82593 4.926281,-15.16153 2.325605,-1.82361 4.222617,-3.52557 4.711482,-4.22705 0.511028,-0.73327 1.468359,-2.89591 2.549152,-5.75859 2.005777,-5.3127 2.756667,-6.53915 4.713278,-7.69833 1.67262,-0.99096 3.79434,-1.37594 8.15213,-1.47923 5.74494,-0.13618 6.57159,-0.41942 11.91598,-4.08295 6.46761,-4.43348 8.51988,-4.39608 15.33151,0.27939 4.72345,3.24215 6.09207,3.70486 11.27986,3.8136 8.79102,0.18428 10.44075,1.29311 13.11462,8.81477 2.17033,6.1052 2.67262,6.82025 7.24033,10.3072 3.46482,2.64502 4.95503,4.20359 5.72574,5.98843 0.90158,2.08787 0.78817,3.52145 -0.71184,8.99847 -0.80826,2.95124 -1.30493,5.26355 -1.32251,6.15716 -0.0168,0.85485 0.51751,3.3468 1.32707,6.18909 2.36616,8.3073 1.87387,9.80901 -4.98223,15.19816 -2.27387,1.78734 -4.17056,3.49455 -4.65552,4.19042 -0.51103,0.73328 -1.46836,2.89592 -2.54915,5.75859 -2.00578,5.31269 -2.75667,6.53914 -4.71328,7.69834 -1.67262,0.99094 -3.79434,1.37594 -8.15213,1.47922 -5.74075,0.13607 -6.57387,0.42099 -11.89289,4.06712 -6.52163,4.47051 -8.52093,4.43654 -15.35547,-0.26092 -4.76078,-3.27214 -6.01383,-3.68538 -11.68428,-3.85324 -4.01838,-0.11896 -6.35848,-0.45078 -7.57947,-1.07475 z"
                    fill="#F2e9df"
                    stroke="#000"
                    strokeWidth="0.5"
                  />
                </svg>
                <AnimationImage
                  src="/images/illust/hippo/hippo_005_a.png"
                  width="110px"
                  top="30px"
                  right="70px"
                  rotate="20deg"
                  animation="nyoki 2s forwards"
                />
                <svg
                  width="450"
                  height="500"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="70.9 170 115 115"
                  style={{ position: "absolute" }}
                >
                  <path
                    id="scaling-path"
                    d="m 100.75502,265.1916 c -2.16308,-1.10542 -3.495995,-3.10693 -5.129849,-7.703 -2.17034,-6.10521 -2.672624,-6.82025 -7.240335,-10.30721 -3.464822,-2.645 -4.955033,-4.20358 -5.725751,-5.98841 -0.901572,-2.08788 -0.788166,-3.52146 0.711847,-8.99849 0.808263,-2.95123 1.304931,-5.26354 1.32251,-6.15715 0.01682,-0.85486 -0.517511,-3.34681 -1.327075,-6.18909 -2.368648,-8.3161 -1.878074,-9.82593 4.926281,-15.16153 2.325605,-1.82361 4.222617,-3.52557 4.711482,-4.22705 0.511028,-0.73327 1.468359,-2.89591 2.549152,-5.75859 2.005777,-5.3127 2.756667,-6.53915 4.713278,-7.69833 1.67262,-0.99096 3.79434,-1.37594 8.15213,-1.47923 5.74494,-0.13618 6.57159,-0.41942 11.91598,-4.08295 6.46761,-4.43348 8.51988,-4.39608 15.33151,0.27939 4.72345,3.24215 6.09207,3.70486 11.27986,3.8136 8.79102,0.18428 10.44075,1.29311 13.11462,8.81477 2.17033,6.1052 2.67262,6.82025 7.24033,10.3072 3.46482,2.64502 4.95503,4.20359 5.72574,5.98843 0.90158,2.08787 0.78817,3.52145 -0.71184,8.99847 -0.80826,2.95124 -1.30493,5.26355 -1.32251,6.15716 -0.0168,0.85485 0.51751,3.3468 1.32707,6.18909 2.36616,8.3073 1.87387,9.80901 -4.98223,15.19816 -2.27387,1.78734 -4.17056,3.49455 -4.65552,4.19042 -0.51103,0.73328 -1.46836,2.89592 -2.54915,5.75859 -2.00578,5.31269 -2.75667,6.53914 -4.71328,7.69834 -1.67262,0.99094 -3.79434,1.37594 -8.15213,1.47922 -5.74075,0.13607 -6.57387,0.42099 -11.89289,4.06712 -6.52163,4.47051 -8.52093,4.43654 -15.35547,-0.26092 -4.76078,-3.27214 -6.01383,-3.68538 -11.68428,-3.85324 -4.01838,-0.11896 -6.35848,-0.45078 -7.57947,-1.07475 z"
                    fill="#946641"
                    stroke="#000"
                    strokeWidth="0.5"
                  />
                </svg>
                <Box
                  id="moving-hippo_017_a"
                  width="70px"
                  position="absolute"
                  top="0px"
                  left="0px"
                >
                  <AnimationImage
                    src="/images/illust/hippo/hippo_017_a.png"
                    width="70px"
                    top="34px"
                    left="162px"
                    rotate="-18deg"
                    animation="nyoki_mole 2s forwards"
                  />
                </Box>
                <svg
                  id="rotating-svg"
                  width="450"
                  height="400"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="70.9 170 115 115"
                  style={{ position: "absolute", zIndex: 101 }}
                >
                  <path
                    id="rotating-path"
                    d="m 100.75502,265.1916 c -2.16308,-1.10542 -3.495995,-3.10693 -5.129849,-7.703 -2.17034,-6.10521 -2.672624,-6.82025 -7.240335,-10.30721 -3.464822,-2.645 -4.955033,-4.20358 -5.725751,-5.98841 -0.901572,-2.08788 -0.788166,-3.52146 0.711847,-8.99849 0.808263,-2.95123 1.304931,-5.26354 1.32251,-6.15715 0.01682,-0.85486 -0.517511,-3.34681 -1.327075,-6.18909 -2.368648,-8.3161 -1.878074,-9.82593 4.926281,-15.16153 2.325605,-1.82361 4.222617,-3.52557 4.711482,-4.22705 0.511028,-0.73327 1.468359,-2.89591 2.549152,-5.75859 2.005777,-5.3127 2.756667,-6.53915 4.713278,-7.69833 1.67262,-0.99096 3.79434,-1.37594 8.15213,-1.47923 5.74494,-0.13618 6.57159,-0.41942 11.91598,-4.08295 6.46761,-4.43348 8.51988,-4.39608 15.33151,0.27939 4.72345,3.24215 6.09207,3.70486 11.27986,3.8136 8.79102,0.18428 10.44075,1.29311 13.11462,8.81477 2.17033,6.1052 2.67262,6.82025 7.24033,10.3072 3.46482,2.64502 4.95503,4.20359 5.72574,5.98843 0.90158,2.08787 0.78817,3.52145 -0.71184,8.99847 -0.80826,2.95124 -1.30493,5.26355 -1.32251,6.15716 -0.0168,0.85485 0.51751,3.3468 1.32707,6.18909 2.36616,8.3073 1.87387,9.80901 -4.98223,15.19816 -2.27387,1.78734 -4.17056,3.49455 -4.65552,4.19042 -0.51103,0.73328 -1.46836,2.89592 -2.54915,5.75859 -2.00578,5.31269 -2.75667,6.53914 -4.71328,7.69834 -1.67262,0.99094 -3.79434,1.37594 -8.15213,1.47922 -5.74075,0.13607 -6.57387,0.42099 -11.89289,4.06712 -6.52163,4.47051 -8.52093,4.43654 -15.35547,-0.26092 -4.76078,-3.27214 -6.01383,-3.68538 -11.68428,-3.85324 -4.01838,-0.11896 -6.35848,-0.45078 -7.57947,-1.07475 z"
                    // fill="#FFF"
                    fill="#fcfcfc"
                    stroke="#444"
                    stroke-width="3"
                  />
                </svg>
                <AnimationImage
                  src="/images/illust/hippo/hippo_020.svg"
                  width="152px"
                  bottom="0px"
                  animation="nyoki_rabit 2s forwards, moveAndRotate 5s infinite 5s"
                />
                <AnimationImage
                  src="/images/illust/hippo/hippo_008.png"
                  width="32px"
                  left="80px"
                  bottom="73px"
                  animation="nyoki_rabit 2s forwards, rabitJump 10s infinite 7s"
                />
                <Box
                  position="fixed"
                  zIndex={100}
                  top="0"
                  left="0"
                  bg="#111"
                  w="100%"
                  h="100%"
                  style={{
                    animation: "feedOut 2s forwards",
                  }}
                />
                <style jsx>{`
                  @keyframes feedOut {
                    0% {
                      opacity: 0.9;
                    }
                    80% {
                      opacity: 0.8;
                    }
                    100% {
                      opacity: 0;
                      display: none;
                    }
                  }
                `}</style>
                <Box
                  position="absolute"
                  zIndex={101}
                  textAlign="center"
                  m={0}
                  p={0}
                  top="90px"
                >
                  <SunderText colorMode={colorMode} text="更新内容" />
                  <Text
                    fontSize="md"
                    fontWeight="400"
                    color={colorMode === "light" ? "#000" : "#000"}
                    mt={-3}
                    mb={1}
                    display="inline-block"
                  >
                    ・5/8 注文システムの公開
                    <br />
                    ・5/8 タイピングをアプリ一覧に移動
                    <br />
                    ・5/18 より現代的なフォルダ構成に変更
                    <br />
                    <br />
                    ・6/20 ヘッダーをリキッドグラスに変更
                    <br />
                    ・6/23 BBSチャットの通知機能を追加
                    <br />
                    ・6/24 モーダルのデザインを修正
                  </Text>
                </Box>
              </Box>
              <Text
                fontSize="sm"
                color={colorMode === "light" ? "#000" : "#FFF"}
                p={1}
                mt={6}
                mb={0}
                fontWeight={400}
              >
                このサイトが停止した場合の連絡はLINEまたはメールでお願いします。
                ファイルのやり取りが難しくなりますが、その時に考えます。
              </Text>
              <Text
                fontSize="sm"
                color={colorMode === "light" ? "#000" : "#FFF"}
                p={1}
                mb={0.5}
                fontWeight={400}
              >
                {/* 2026年初旬の再開を予定しています。 */}
                {/* 再開時期は未定です */}
              </Text>
              <Box as="span" fontSize="sm" fontWeight={400} zIndex={100}>
                <Box display="flex" alignItems="center">
                  <a
                    href="mailto:teppy422@au.com"
                    style={{
                      display: "flex",
                      alignItems: "center",
                      textDecoration: "none",
                      color: "inherit",
                    }}
                  >
                    <IoIosMail
                      style={{
                        marginTop: "3px",
                        marginRight: "2px",
                        fontSize: "19px",
                      }}
                      color="gray"
                    />
                    teppy422@au.com
                  </a>
                  <Box display="flex" alignItems="center">
                    <Link
                      href="https://page.line.me/892soxnj" // ← LINE公式で発行した招待リンク
                      isExternal
                      display="flex"
                      alignItems="center"
                    >
                      <FaLine
                        style={{
                          marginTop: "4px",
                          marginLeft: "10px",
                          marginRight: "3px",
                          fontSize: "16px",
                        }}
                        color="gray"
                      />
                      teppy0422
                    </Link>
                  </Box>
                </Box>
              </Box>
              <Box as="span" fontSize="sm" fontWeight={400} zIndex={100}>
                <Link
                  href="tel:07091336256"
                  _hover={{ textDecoration: "none" }}
                  _focus={{ boxShadow: "none" }}
                >
                  <Box display="flex" alignItems="center">
                    <PhoneIcon
                      size="18px"
                      fill={
                        colorMode === "light"
                          ? "custom.theme.light.900"
                          : "custom.theme.dark.200"
                      }
                    />
                    070-9133-6256
                  </Box>
                </Link>
              </Box>
              <Box
                as="button"
                onClick={onClose} // モーダルを閉じる関数を呼び出す
                position="absolute"
                bottom="0"
                _focus={{ boxShadow: "none" }}
                fontFamily="Dela Gothic One"
                color="#82d9d0"
                // color="transparent"
                bg="#211c1c"
                fontSize="18px"
                // borderTop="solid 1px #000"
                cursor="pointer"
                overflow="hidden" // ボックスからはみ出さないようにする
                w="100%"
              >
                <ScrollText colorMode={colorMode} text="CLOSE&nbsp;" />
              </Box>
              <AnimationImage
                src="/images/illust/hippo/hippo_a001_lyingDown.png"
                width="92px"
                right="2px"
                bottom="24px"
                animation="dropBounce 5s forwards"
              />
            </Box>
          </ModalBody>
          <ModalFooter>
            {/* <Button colorScheme="blue" onClick={() => setAlertModalOpen(false)}>
              閉じる
            </Button> */}
          </ModalFooter>
        </Box>
      </ModalContent>
    </Modal>
  );
};

export default AlertModal;
